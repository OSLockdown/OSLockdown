<?xml version="1.0" encoding="UTF-8"?>
<profile name="NSA Guide" sysProfile="true">
    <info>
        <description>
            <summary>NSA Secure Configuration Guide</summary>
            <verbose>Recommended for systems that require maximum security. Locking down a system using these settings provides a rigorous defense against sophisticated security concerns.</verbose>
            <comments>The National Security Agency's Information Assurance Mission group publishes the "Guide to the Secure Configuration of Red Hat Enterprise Linux 5". This profile addresses operating system configuration items with the exception of firewall rules and those procedures which should be performed manually.</comments>
        </description>
    </info>
    <security_module name="Access.conf File Permissions">
        <option name="fileList">/etc/security/access.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="At Directory Permissions">
        <option name="fileList">/var/spool/at</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="At/Cron Access File Permissions">
        <option name="fileList">/etc/at.allow /etc/at.deny /etc/cron.allow /etc/cron.deny</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,cron</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Audit Log Rotation"/>
    <security_module name="Audit Rules">
        <option name="auditRules">
# This file is automatically generated by OS Lockdown
# in support of NSA's:
#
# "Secure Configuration of Red Hat Enterprise Linux 5"
#   - Revision 3 Oct 2009
#

# First rule - delete all
-D

# Increase the buffers to survive stress events.
# Make this bigger for busy systems
-b 8192

# 2.6.2.4.1 Records Events that Modify Date and Time Information
-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change
-a always,exit -F arch=b64 -S adjtimex -S settimeofday -S stime -k time-change
-a always,exit -F arch=b32 -S clock_settime -k time-change
-a always,exit -F arch=b64 -S clock_settime -k time-change
-w /etc/localtime -p wa -k time-change

# 2.6.2.4.2 Record Events that Modify User/Group Information
-w /etc/group -p wa -k identity
-w /etc/passwd -p wa -k identity
-w /etc/gshadow -p wa -k identity
-w /etc/shadow -p wa -k identity
-w /etc/security/opasswd -p wa -k identity

# 2.6.2.4.3 Record Events that Modify the System's Network Environment
-a exit,always -F arch=b32 -S sethostname -S setdomainname -k system-locale
-a exit,always -F arch=b64 -S sethostname -S setdomainname -k system-locale
-w /etc/issue -p wa -k system-locale
-w /etc/issue.net -p wa -k system-locale
-w /etc/hosts -p wa -k system-locale
-w /etc/sysconfig/network -p wa -k system-locale

# 2.6.2.4.4 Record Events that Modify the System's Mandatory Access Controls
-w /etc/selinux/ -p wa -k MAC-policy

# 2.6.2.4.5 Ensure auditd Collects Logon and Logout Events
-w /var/log/faillog -p wa -k logins
-w /var/log/lastlog -p wa -k logins

# 2.6.2.4.6 Ensure auditd Collects Process and Session Initiation Information
-w /var/run/utmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/wtmp -p wa -k session

# 2.6.2.4.7 Ensure auditd Collects Discretionary Access Control Permission Modification Events
# 32 bit Machines
-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
# 64 bit Machines
-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid&gt;=500 -F auid!=4294967295 -k perm_mod
-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid&gt;=500 -F auid!=4294967295 -k perm_mod

# 2.6.2.4.8 Ensure auditd Collects Unauthorized Access Attempts to Files (unsuccessful)
# 32 bit machines
-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access
-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access
# 64 bit machines
-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid&gt;=500 -F auid!=4294967295 -k access
-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid&gt;=500 -F auid!=4294967295 -k access

# 2.6.2.4.9 Ensure auditd Collects Information on the Use of Privileged Commands
-a always,exit -F path=/bin/ping -F perm=x -F auid&gt;=500 -F auid!=4294967295 -k privileged

# 2.6.2.4.10 Ensure auditd Collects Information on Exporting to Media (successful)
-a always,exit -F arch=b32 -S mount -F auid&gt;=500 -F auid!=4294967295 -k export
-a always,exit -F arch=b64 -S mount -F auid&gt;=500 -F auid!=4294967295 -k export

2.6.2.4.11 Ensure auditd Collects Files Deletion Events by User (successful and unsuccessful)
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete
-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete

# 2.6.2.4.12 Ensure auditd Collects System Administrator Actions
-w /etc/sudoers -p wa -k actions

# 2.6.2.4.13 Make the auditd Configuration Immutable
#  - NOTE: With this setting, a reboot will be required to change any audit rules.
-e 2
        </option>
    </security_module>
    <security_module name="Bind Mount /var/tmp to /tmp"/>
    <security_module name="Block System Accounts"/>
    <security_module name="Boot Loader Configuration File Permissions">
        <option name="fileList">/boot/grub</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Check Kernel for XD/NX Support"/>
    <security_module name="Check for separate /home file system"/>
    <security_module name="Check for separate /tmp file system"/>
    <security_module name="Check for separate /var file system"/>
    <security_module name="Check for separate /var/log file system"/>
    <security_module name="Check for separate /var/log/audit file system"/>
    <security_module name="Configure Sendmail Options"/>
    <security_module name="Create Login Banner">
        <option name="loginBanner">
THIS IS A DEPARTMENT OF DEFENSE COMPUTER SYSTEM.  THIS COMPUTER SYSTEM,
INCLUDING ALL RELATED EQUIPMENT, NETWORKS, AND NETWORK DEVICES (SPECIFICALLY
INCLUDING INTERNET ACCESS), ARE PROVIDED ONLY FOR AUTHORIZED US GOVERNMENT USE.
DOD COMPUTER SYSTEMS MAY BE MONITORED FOR ALL LAWFUL PURPOSES, INCLUDING TO
ENSURE THEIR USE IS AUTHORIZED, FOR MANAGEMENT OF THE SYSTEM, TO FACILITATE
PROTECTION AGAINST UNAUTHORIZED ACCESS, AND TO VERIFY SECURITY PROCEDURES,
SURVIVABILITY, AND OPERATIONAL SECURITY.  MONITORING INCLUDES ACTIVE ATTACKS BY
AUTHORIZED DOD ENTITIES TO TEST OR VERIFY THE SECURITY OF THIS SYSTEM.  DURING
MONITORING, INFORMATION MAY BE EXAMINED, RECORDED, COPIED, AND USED FOR
AUTHORIZED PURPOSES.  ALL INFORMATION, INCLUDING PERSONAL INFORMATION, PLACED
ON OR SENT OVER THIS SYSTEM, MAY BE MONITORED.

USE OF THIS DOD COMPUTER SYSTEM, AUTHORIZED OR UNAUTHORIZED, CONSTITUTES
CONSENT TO MONITORING OF THIS SYSTEM.  UNAUTHORIZED USE MAY SUBJECT YOU TO
CRIMINAL PROSECUTION.  EVIDENCE OF UNAUTHORIZED USE COLLECTED DURING MONITORING
MAY BE USED FOR ADMINISTRATIVE, CRIMINAL, OR OTHER ADVERSE ACTION. USE OF THIS
SYSTEM CONSTITUTES CONSENT TO MONITORING FOR THESE PURPOSES.
      </option>
    </security_module>
    <security_module name="Create Login FTP Banner">
        <option name="ftpLoginBanner">Authorized uses only. All activity may be monitored and reported.</option>
    </security_module>
    <security_module name="Crontab Perms">
        <option name="userSpoolDirs">/var/spool/cron/ /etc/crontab</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root cron </option>
        <option name="userCanOwn">1</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Daemon Umask"/>
    <security_module name="Disable ACPI Daemon"/>
    <security_module name="Disable Apache"/>
    <security_module name="Disable Avahi Daemon"/>
    <security_module name="Disable Bluetooth"/>
    <security_module name="Disable Bluetooth Input Devices Daemon"/>
    <security_module name="Disable Bluetooth Kernel Modules">
        <option name="requiredLines">alias net-pf-31 off
alias bluetooth off
install bluetooth /bin/true</option>
    </security_module>
    <security_module name="Disable Boot Caching"/>
    <security_module name="Disable CPU Throttling"/>
    <security_module name="Disable CUPS Printer Browsing"/>
    <security_module name="Disable Console Mouse Support"/>
    <security_module name="Disable Core Dumps"/>
    <security_module name="Disable DNS"/>
    <security_module name="Disable Dhcpd"/>
    <security_module name="Disable FTP (gssftp)"/>
    <security_module name="Disable FTP (vsftpd)"/>
    <security_module name="Disable Finger"/>
    <security_module name="Disable Firstboot Service"/>
    <security_module name="Disable Fspd"/>
    <security_module name="Disable GNOME Automounting"/>
    <security_module name="Disable Gated"/>
    <security_module name="Disable Graphical Login"/>
    <security_module name="Disable HAL Daemon"/>
    <security_module name="Disable HP Printing and Imaging"/>
    <security_module name="Disable IA32 Microcode Utility"/>
    <security_module name="Disable IPv6 Kernel Module">
        <option name="requiredLines">alias ipv6 off
alias net-pf-10 off</option>
    </security_module>
    <security_module name="Disable IRDA Service"/>
    <security_module name="Disable IRQ Balance Service"/>
    <security_module name="Disable ISDN"/>
    <security_module name="Disable Inetd"/>
    <security_module name="Disable Innd"/>
    <security_module name="Disable Interactive Boot"/>
    <security_module name="Disable Kernel Crash Analyzer"/>
    <security_module name="Disable Kudzu"/>
    <security_module name="Disable MCS Translation Service"/>
    <security_module name="Disable Mail (Cyrus mail server)"/>
    <security_module name="Disable Mail (Dovecot mail server)"/>
    <security_module name="Disable Mounting of Uncommon Filesystem Types">
        <option name="requiredLines">install cramfs /bin/true
install freevxfs /bin/true
install jffs2 /bin/true
install hfsplus /bin/true
install squashfs /bin/true
install udf /bin/true</option>
    </security_module>
    <security_module name="Disable NFS Client"/>
    <security_module name="Disable NIS Client"/>
    <security_module name="Disable NetFS"/>
    <security_module name="Disable Portmap Daemon"/>
    <security_module name="Disable Power Management"/>
    <security_module name="Disable Prelinking"/>
    <security_module name="Disable Printer Daemon"/>
    <security_module name="Disable Raw Devices Service"/>
    <security_module name="Disable Remote Exec (rexec)"/>
    <security_module name="Disable Remote Login (rlogin)"/>
    <security_module name="Disable Remote Shell (rsh)"/>
    <security_module name="Disable Restorecon"/>
    <security_module name="Disable Rhnsd"/>
    <security_module name="Disable Rhosts Support"/>
    <security_module name="Disable Routed"/>
    <security_module name="Disable SETroubleshoot"/>
    <security_module name="Disable SMART Disk Monitoring Support"/>
    <security_module name="Disable SMB"/>
    <security_module name="Disable SNMP"/>
    <security_module name="Disable SUID Core Dumps"/>
    <security_module name="Disable Sendmail">
        <option name="requiredLines">DAEMON=no</option>
    </security_module>
    <security_module name="Disable Smart Card Support"/>
    <security_module name="Disable Software RAID Monitor"/>
    <security_module name="Disable Squid"/>
    <security_module name="Disable Support for DCCP">
        <option name="requiredLines">install dccp /bin/true</option>
    </security_module>
    <security_module name="Disable Support for RDS">
        <option name="requiredLines">install rds /bin/true</option>
    </security_module>
    <security_module name="Disable Support for SCTP">
        <option name="requiredLines">install sctp /bin/true</option>
    </security_module>
    <security_module name="Disable Support for TIPC">
        <option name="requiredLines">install tipc /bin/true</option>
    </security_module>
    <security_module name="Disable TFTP"/>
    <security_module name="Disable Telnet"/>
    <security_module name="Disable Tux"/>
    <security_module name="Disable USB and PCMCIA Devices">
        <option name="usbDevices">2</option>
    </security_module>
    <security_module name="Disable UUCP"/>
    <security_module name="Disable Webmin"/>
    <security_module name="Disable XFS"/>
    <security_module name="Disable Zeroconf Networking"/>
    <security_module name="Disable atd Service"/>
    <security_module name="Disable rpc.ugidd"/>
    <security_module name="Enable Auditing For All Processes"/>
    <security_module name="Enable ExecShield Kernel Module">
        <option name="requiredLines">kernel.exec-shield=1
kernel.randomize_va_space=1</option>
    </security_module>
    <security_module name="Enable Iptables"/>
    <security_module name="Enable Ip6tables"/>
    <security_module name="Enable the Audit Subsystem"/>
    <security_module name="Ensure SELinux is Properly Enabled">
        <option name="SELINUX">enforcing</option>
        <option name="SELINUXTYPE">targeted</option>
    </security_module>
    <security_module name="Exec shell startups in /etc/profile.d"/>
    <security_module name="FTP Configuration File Permissions">
        <option name="fileList">/etc/ftpusers /etc/vsftpd.ftpusers</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="GRUB Boot Single Image"/>
    <security_module name="Global Initialization File Permissions">
        <option name="fileList">/etc/bashrc /etc/csh.cshrc /etc/csh.login /etc/csh.logout, /etc/environment,
                                /etc/ksh.kshrc, /etc/profile, /etc/profile.d /etc/suid_profile</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,other,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Hosts File Permissions">
        <option name="fileList">/etc/hosts</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Inetd/Xinetd Configuration File Permissions">
        <option name="fileList">/etc/xinetd.conf /etc/xinetd.d/*</option>
        <option name="recursive">1</option>
        <option name="globNames">1</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Kernel Core Dump Directory Permissions">
        <option name="fileList">/var/crash</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">700</option>
    </security_module>
    <security_module name="LDAP Configuration File Permissions">
        <option name="fileList">/etc/ldap.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Limit Access To Root From Su">
        <option name="requireNonRootWheelMember">0</option>
    </security_module>
    <security_module name="Limit Password Reuse">
        <option name="passwordReuse">5</option>
    </security_module>
    <security_module name="Lock Non-Root Accounts with UID 0"/>
    <security_module name="Lock account after three failed login attempts"/>
    <security_module name="Management Information Base (MIB) File Permissions">
        <option name="fileList">/usr/share/snmp/mibs/*.txt /usr/share/snmp/mibs/*.mib</option>
        <option name="recursive">0</option>
        <option name="globNames">1</option>
        <option name="allowedUnames"/>
        <option name="allowedGnames"/>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Maximum Time Between Password Changes">
        <option name="passwordMaxdays">60</option>
    </security_module>
    <security_module name="NFS Export Configuration File Permissions">
        <option name="fileList">/etc/exports</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="NIS/NIS+/YP Configuration File Permissions">
        <option name="fileList">/etc/yp /var/yp /etc/yp.conf</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin,sys</option>
        <option name="allowedGnames">root,bin,sys</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="Name Service Switch Configuration File Permissions">
        <option name="fileList">/etc/nsswitch.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="No Empty Passwords"/>
    <security_module name="No Plus Entries in Password Files"/>
    <security_module name="PHP - Disallow HTTP File Uploads"/>
    <security_module name="PHP - General Security"/>
    <security_module name="PHP - Set Error Logging"/>
    <security_module name="Password Perms">
        <option name="fileList">/etc/passwd /etc/group</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Password Policy Length Minimum">
        <option name="passwordMinLength">8</option>
    </security_module>
    <security_module name="Password Policy Lowercase Minimum"/>
    <security_module name="Password Policy Numeric Minimum"/>
    <security_module name="Password Policy Special Characters"/>
    <security_module name="Password Policy Uppercase Minimum"/>
    <security_module name="Printer Configuration File Permissions">
        <option name="fileList">/etc/cups/printers.conf</option>
        <option name="recursive">0</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">lp</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Resolver Configuration File Permissions">
        <option name="fileList">/etc/resolv.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Restrict Remote X Clients"/>
    <security_module name="Root Console Only Logins">
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root</option>
        <option name="dacs">640</option>
        <option name="secureDevices">console,tty1,tty2,tty2,tty3,tty4,tty5</option>
    </security_module>
    <security_module name="Root Path"/>
    <security_module name="SMB Configuration"/>
    <security_module name="SNMP Configuration File Permissions">
        <option name="fileList">/etc/snmp</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="SSHD Disable Empty Passwords"/>
    <security_module name="SSHD Disable Host-based Authentication"/>
    <security_module name="SSHD Disable Rhosts Authentication"/>
    <security_module name="SSHD Disable Root Login"/>
    <security_module name="SSHD Enable Banner"/>
    <security_module name="SSHD Enable Ignore Rhosts"/>
    <security_module name="SSHD Protocol"/>
    <security_module name="SSHD Set Idle Timeout Interval for User Logins">
        <option name="sshdIdleTimeout">900</option>
    </security_module>
    <security_module name="Samba Configuration File Permissions">
        <option name="fileList">/etc/samba/smb.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Samba Password File Permissions">
        <option name="fileList">/etc/samba/passdb.tdb /etc/samba/secrets.tdb</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Secure Authpriv Logging"/>
    <security_module name="Secure Option for NFS Server"/>
    <security_module name="Secure SUID/SGID Executables"/>
    <security_module name="Secure Unowned Files"/>
    <security_module name="Secure World Writable Directories"/>
    <security_module name="Secure World Writable Files"/>
    <security_module name="Services File Permissions">
        <option name="fileList">/etc/services</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Set Mandatory Screen Saver">
        <option name="gnomeSaverActivate">15</option>
    </security_module>
    <security_module name="Set Password Aging on Active Accounts">
        <option name="passwordAgingMindays">7</option>
        <option name="passwordAgingMaxdays">60</option>
        <option name="passwordAgingExpireWarning">50</option>
        <option name="passwordAgingInvalidate">7</option>
        <option name="exemptSystemAccounts">0</option>
        <option name="exemptSpecificAccounts"/>
    </security_module>
    <security_module name="Set shell timeout period">
        <option name="shellTimeout">900</option>
    </security_module>
    <security_module name="Single User Mode Password"/>
    <security_module name="Skeleton File Permissions">
        <option name="fileList">/etc/skel</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system,other</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="System Configuration File Permissions"/>
    <security_module name="System Logging Configuration File Permissions">
        <option name="fileList">/etc/syslog.conf</option>
        <option name="recursive">0</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Use NODEV Option for Non-root Partitions"/>
    <security_module name="Use NOSUID and NODEV for Removable Media"/>
    <security_module name="User Dot File Perms"/>
</profile>
