<?xml version="1.0" encoding="UTF-8"?>
<profile name="DISA UNIX STIG" sysProfile="true">
    <info>
        <description>
            <summary>UNIX Security Technical Implementation Guide</summary>
            <verbose>Recommended for systems that require maximum security. Locking down a system using these settings provides a rigorous defense against sophisticated security concerns.</verbose>
            <comments>The Security Technical Implementation Guides (STIGs) are the configuration standards for U.S. Department of Defense (DOD) Information Assurance (IA) and IA-enabled devices/systems. The guides are maintained and published by the Defense Information Systems Agency's (DISA) Field Security Office (FSO). Approximately every ninety days the FSO publishes updates to its checklists.</comments>
        </description>
    </info>
    <security_module name="Access.conf File Permissions">
        <option name="fileList">/etc/security/access.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Adjust Maximum Pending Connections">
        <option name="tcpMaxSynBacklog">1280</option>
    </security_module>
    <security_module name="At Directory Permissions">
        <option name="fileList">/var/spool/at</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="At/Cron Access File Permissions">
        <option name="fileList">/etc/at.allow /etc/at.deny /etc/cron.allow /etc/cron.deny</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,cron</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Audit Log Rotation"/>
    <security_module name="Audit Rules">
        <option name="auditRules">
# This file is automatically generated by OS Lockdown

# This file contains the auditctl rules that are loaded
# whenever the audit daemon is started via the initscripts.
# The rules are simply the parameters that would be passed
# to auditctl.

# First rule - delete all
-D

# Increase the buffers to survive stress events.
# Make this bigger for busy systems
-b 8192

# Feel free to add below this line. See auditctl man page

# Logins and Logouts
-w /bin/login -p x
-w /bin/su

-a exit,always -S mknod -S pipe -S mkdir -S creat -F success=0
-a exit,always -S open -F success=0
-a exit,always -F arch=b32 -S truncate -S ftruncate -F success=0
-a exit,always -F arch=b64 -S truncate -S ftruncate -F success=0

-a exit,always -S unlink -S rmdir -S rename -F success!=0

-w /bin/rm 

-a exit,always -F arch=b32 -S chmod -S fchmod -S chown -S fchown -S lchown
-a exit,always -F arch=b64 -S chmod -S fchmod -S chown -S fchown -S lchown

-a exit,always -S chroot -S mount -S umount -S umount2

-w /usr/sbin/pwck
-a exit,always -S adjtimex -S settimeofday -S kill

-w /bin/chgrp
-w /usr/bin/newgrp
-w /usr/sbin/groupadd
-w /usr/sbin/groupmod
-w /usr/sbin/groupdel

-w /usr/sbin/useradd
-w /usr/sbin/userdel
-w /usr/sbin/usermod
-w /usr/bin/chage
-a exit,always -S reboot -S init_module -S delete_module
-w /usr/bin/setfacl
-w /usr/bin/chacl
-a exit,always -S chmod -S fchmod -S link -S symlink

# GEN002760 - Audit Administrative, Privileged, and Security Actions
-w /etc/auditd.conf
-w /etc/audit/auditd.conf
-w /etc/audit.rules
-w /etc/audit/audit.rules
-a exit,always -S stime -S acct -S swapon
-a exit,always -S setrlimit -S setdomainname
-a exit,always -S sched_setparam -S sched_setscheduler
        </option>
    </security_module>
    <security_module name="Audit Rules (Solaris)">
        <option name="auditRules">
#
# This file is automatically generated by OS Lockdown
#   See audit_control(4) for more details
#
# flags:
# -fr = GEN002720 (Audit Failed File and Program Access Attempts)
#  fd = GEN002740 (Audit File and Program Deletion)
#  am = GEN002760 (Audit Administrative, Privileged, and Security Actions)
#  ad = GEN002760 (old administrative (meta-class))
#  lo = GEN002800 (Audit Login, Logout, and Session Initiation)
#  fm = GEN002820 (Audit Discretionary Access Control Permission Modifications)
# 
# naflags:
#  lo = GEN002800 (Audit Login, Logout, and Session Initiation)
#  ex =           (exec)
#  ad =           (old administrative (meta-class))
#
dir:/var/audit
flags:-fr,fd,am,ad,lo,fm
naflags:lo,ex,ad
minfree:20
      </option>
    </security_module>
    <security_module name="Block System Accounts"/>
    <security_module name="Boot Loader Configuration File Permissions">
        <option name="fileList">/boot/grub</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Configure Sendmail Options"/>
    <security_module name="Configure User Firefox Prefs"/>
    <security_module name="Correct Global Init Script PATH Variables"/>
    <security_module name="Correct System RC Script PATH Variables"/>
    <security_module name="Correct Uneven File Permissions"/>
    <security_module name="Create Login Banner">
        <option name="loginBanner">You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests- -not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details. 
      </option>
    </security_module>
    <security_module name="Create Login FTP Banner">
        <option name="ftpLoginBanner">Authorized uses only. All activity may be monitored and reported.</option>
    </security_module>
    <security_module name="Create Pre-Login GUI Banner">
        <option name="preLoginBanner">All users will be required to read and accept a 'Consent to Monitor' 
statement before being allowed to login.  The response will be logged.</option>
    </security_module>
    <security_module name="Create Pre-Session GUI Banner">
        <option name="requireAssent">1</option>
        <option name="bannerSrc">0</option>
        <option name="bannerText">Insert your text here</option>
        <option name="formatBanner">1</option>
    </security_module>
    <security_module name="Create ftpusers File"/>
    <security_module name="Cron Logging"/>
    <security_module name="Crontab Perms">
        <option name="userSpoolDirs">/var/spool/cron/ /etc/crontab</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root cron </option>
        <option name="userCanOwn">1</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Default umask">
        <option name="defaultUmask">077</option>
    </security_module>
    <security_module name="Deny NFS Client Access Without UID or GID"/>
    <security_module name="Disable Accepting ICMP Redirects"/>
    <security_module name="Disable Accepting Secure Redirects"/>
    <security_module name="Disable Console.perms"/>
    <security_module name="Disable Core Dumps"/>
    <security_module name="Disable Ctrl-Alt-Del"/>
    <security_module name="Disable FTP (vsftpd)"/>
    <security_module name="Disable File Sharing Networks"/>
    <security_module name="Disable Finger"/>
    <security_module name="Disable Firefox if older than 3.0"/>
    <security_module name="Disable Fspd"/>
    <security_module name="Disable Graphical Login"/>
    <security_module name="Disable IP Forwarding"/>
    <security_module name="Disable Inetd"/>
    <security_module name="Disable Innd"/>
    <security_module name="Disable Instant Messenger Client (Yahoo!)"/>
    <security_module name="Disable Instant Messenger Client (gaim)"/>
    <security_module name="Disable Kernel Crash Analyzer"/>
    <security_module name="Disable Network Analysis Tools"/>
    <security_module name="Disable PAM Console Library"/>
    <security_module name="Disable Proxy Address Resolution Protocol (Proxy ARP)"/>
    <security_module name="Disable Remote Exec (rexec)"/>
    <security_module name="Disable Remote Login (rlogin)"/>
    <security_module name="Disable Remote Shell (rsh)"/>
    <security_module name="Disable Remote Syslog"/>
    <security_module name="Disable Rhosts Support"/>
    <security_module name="Disable SMB"/>
    <security_module name="Disable SNMP"/>
    <security_module name="Disable SNMP if default public string exists"/>
    <security_module name="Disable Sending ICMP Redirects"/>
    <security_module name="Disable Sendmail Help"/>
    <security_module name="Disable Sendmail if older than 8.13.8"/>
    <security_module name="Disable Source Routing"/>
    <security_module name="Disable Squid if older than 2.4STABLE6"/>
    <security_module name="Disable Telnet"/>
    <security_module name="Disable UUCP"/>
    <security_module name="Disable rpc.ugidd"/>
    <security_module name="Enable Reverse Path Source Validation"/>
    <security_module name="Enable Stack Protection"/>
    <security_module name="Enable Strong TCP Sequence Number Generation"/>
    <security_module name="Enable TCP Syncookies"/>
    <security_module name="Enable TCP Wrappers">
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,</option>
        <option name="dacs">644</option>
        <option name="requiredLinesForAllow"/>
        <option name="requiredLinesForDeny">ALL: ALL"</option>
    </security_module>
    <security_module name="Enable the Audit Subsystem"/>
    <security_module name="Enable vsftpd Additional Logging"/>
    <security_module name="Exec shell startups in /etc/profile.d"/>
    <security_module name="Expired Password Invalidation"/>
    <security_module name="FTP Configuration File Permissions">
        <option name="fileList">/etc/ftpusers /etc/vsftpd.ftpusers</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Firefox - Encryption"/>
    <security_module name="Firefox - Java">
        <option name="FirefoxJava">0</option>
    </security_module>
    <security_module name="Firefox - Privacy"/>
    <security_module name="Firefox - Updating">
        <option name="FirefoxAutoUpdate">0</option>
    </security_module>
    <security_module name="GRUB Boot Single Image"/>
    <security_module name="Global Initialization File Permissions">
        <option name="fileList">/etc/bashrc /etc/csh.cshrc /etc/csh.login /etc/csh.logout, /etc/environment,
                                /etc/ksh.kshrc, /etc/profile, /etc/profile.d /etc/suid_profile</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,other,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Home Directory Contents"/>
    <security_module name="Home Directory Ownership"/>
    <security_module name="Home Directory Permissions"/>
    <security_module name="Hosts File Permissions">
        <option name="fileList">/etc/hosts</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Ignore ICMP ECHO and TIMESTAMP Requests"/>
    <security_module name="Inetd/Xinetd Configuration File Permissions">
        <option name="fileList">/etc/xinetd.conf /etc/xinetd.d/*</option>
        <option name="recursive">1</option>
        <option name="globNames">1</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="InterNetNews Config File Perms">
        <option name="fileList">/etc/news/*</option>
        <option name="globNames">1</option>
        <option name="allowedUnames">root,news</option>
        <option name="allowedGnames">root,news</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Kernel Core Dump Directory Permissions">
        <option name="fileList">/var/crash</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">700</option>
    </security_module>
    <security_module name="LDAP Configuration File Permissions">
        <option name="fileList">/etc/ldap.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Limit Access To Root From Su">
        <option name="requireNonRootWheelMember">0</option>
    </security_module>
    <security_module name="Limit Password Reuse">
        <option name="passwordReuse">5</option>
    </security_module>
    <security_module name="Limit Term Write-access to Owner">
        <option name="filesToSearch">/etc/bashrc /etc/csh.cshrc /etc/csh.login
        /etc/csh.logout /etc/ksh.kshrc
        /etc/profile /etc/suid_profile /etc/profile.d/*
      </option>
    </security_module>
    <security_module name="Lock Invalid Accounts"/>
    <security_module name="Lock Non-Root Accounts with UID 0"/>
    <security_module name="Lock account after three failed login attempts"/>
    <security_module name="Log Critical Sendmail Messages"/>
    <security_module name="Management Information Base (MIB) File Permissions">
        <option name="fileList">/usr/share/snmp/mibs/*.txt /usr/share/snmp/mibs/*.mib</option>
        <option name="recursive">0</option>
        <option name="globNames">1</option>
        <option name="allowedUnames"/>
        <option name="allowedGnames"/>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Maximum Time Between Password Changes">
        <option name="passwordMaxdays">60</option>
    </security_module>
    <security_module name="Minimum Delay Between Password Changes">
        <option name="passwordMindays">1</option>
    </security_module>
    <security_module name="NFS Export Configuration File Permissions">
        <option name="fileList">/etc/exports</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="NIS/NIS+/YP Configuration File Permissions">
        <option name="fileList">/etc/yp /var/yp /etc/yp.conf</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin,sys</option>
        <option name="allowedGnames">root,bin,sys</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="Name Service Switch Configuration File Permissions">
        <option name="fileList">/etc/nsswitch.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="No Empty Passwords"/>
    <security_module name="No Hashes Allowed in Passwd/Group Files">
        <option name="fileList">/etc/passwd /etc/group</option>
    </security_module>
    <security_module name="No Plus Entries in Password Files"/>
    <security_module name="Password Perms">
        <option name="fileList">/etc/passwd /etc/group</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Password Policy Length Minimum">
        <option name="passwordMinLength">14</option>
    </security_module>
    <security_module name="Password Policy Lowercase Minimum"/>
    <security_module name="Password Policy Numeric Minimum"/>
    <security_module name="Password Policy Special Characters"/>
    <security_module name="Password Policy Uppercase Minimum"/>
    <security_module name="Printer Configuration File Permissions">
        <option name="fileList">/etc/cups/printers.conf</option>
        <option name="recursive">0</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">lp</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Remove Games User Account"/>
    <security_module name="Remove Gopher User Account"/>
    <security_module name="Remove Halt User Account"/>
    <security_module name="Remove Insecure_Locks option for NFS Server"/>
    <security_module name="Remove News User Account"/>
    <security_module name="Remove SMB Guest Authentication"/>
    <security_module name="Remove Shutdown User Account"/>
    <security_module name="Remove Sync User Account"/>
    <security_module name="Remove Telnet Service Banner"/>
    <security_module name="Remove ftp Account"/>
    <security_module name="Require GRUB Password"/>
    <security_module name="Resolver Configuration File Permissions">
        <option name="fileList">/etc/resolv.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Restrict At and Cron"/>
    <security_module name="Restrict Use of Traceroute and Ping">
        <option name="fileList">/bin/traceroute /usr/sbin/traceroute</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys</option>
        <option name="dacs">700</option>
    </security_module>
    <security_module name="Restrict Write-Access on Man Pages">
        <option name="fileList">/usr/share/man /usr/share/info /usr/share/infopage</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames"/>
        <option name="allowedGnames"/>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Restrict use of Mesg command"/>
    <security_module name="Root Console Only Logins">
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin</option>
        <option name="dacs">640</option>
        <option name="secureDevices">console</option>
    </security_module>
    <security_module name="Root Home Directory Permissions">
        <option name="dacs">700</option>
    </security_module>
    <security_module name="Root Path"/>
    <security_module name="Root shell must be on / filesystem"/>
    <security_module name="SMB Configuration"/>
    <security_module name="SNMP Configuration File Permissions">
        <option name="fileList">/etc/snmp</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="SSH Parameters"/>
    <security_module name="SSHD Disable Root Login"/>
    <security_module name="SSHD Enable Banner"/>
    <security_module name="SSHD Protocol"/>
    <security_module name="SSHD Set Idle Timeout Interval for User Logins">
        <option name="sshdIdleTimeout">900</option>
    </security_module>
    <security_module name="Samba Configuration File Permissions">
        <option name="fileList">/etc/samba/smb.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Samba Password File Permissions">
        <option name="fileList">/etc/samba/passdb.tdb /etc/samba/secrets.tdb</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Secure Audio Devices"/>
    <security_module name="Secure Authpriv Logging"/>
    <security_module name="Secure Netrc Files"/>
    <security_module name="Secure Option for NFS Server"/>
    <security_module name="Secure SUID/SGID Executables"/>
    <security_module name="Secure Shell Binaries">
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,sys,bin,system</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="Secure Unowned Files"/>
    <security_module name="Secure World Writable Directories"/>
    <security_module name="Secure World Writable Files"/>
    <security_module name="Services File Permissions">
        <option name="fileList">/etc/services</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Set CDE Screen Saver">
        <option name="cdeSaverActivate">15</option>
    </security_module>
    <security_module name="Set FTP Umask (gssftp)"/>
    <security_module name="Set Mandatory Screen Saver">
        <option name="gnomeSaverActivate">15</option>
    </security_module>
    <security_module name="Set Password Aging on Active Accounts">
        <option name="passwordAgingMindays">1</option>
        <option name="passwordAgingMaxdays">60</option>
        <option name="passwordAgingExpireWarning">50</option>
        <option name="passwordAgingInvalidate">1</option>
        <option name="exemptSystemAccounts">0</option>
        <option name="exemptSpecificAccounts"/>
    </security_module>
    <security_module name="Set TFTP Startup Directory"/>
    <security_module name="Set X Screen Saver Application Defaults">
        <option name="XscreenSaverActivate">15</option>
    </security_module>
    <security_module name="Set delay after failed login">
        <option name="loginDelay">4</option>
    </security_module>
    <security_module name="Set shell timeout period">
        <option name="shellTimeout">900</option>
    </security_module>
    <security_module name="Shadow Perms">
        <option name="fileList">/etc/shadow /etc/gshadow</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root</option>
        <option name="dacs">400</option>
    </security_module>
    <security_module name="Single User Mode Password"/>
    <security_module name="Skeleton File Permissions">
        <option name="fileList">/etc/skel</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system,other</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Sync Shells File"/>
    <security_module name="Sysctl.conf Permissions"/>
    <security_module name="System Command File Permissions">
        <option name="fileList">/etc /bin /usr/bin /usr/lbin /usr/usb /sbin /usr/sbin</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="System Configuration File Permissions"/>
    <security_module name="System Device Directory Ownership"/>
    <security_module name="System Library File Permissions">
      <option name="fileList">/lib /lib64 /usr/lib /usr/lib64</option>
      <option name="recursive">1</option>
      <option name="globNames">0</option>
      <option name="allowedUnames">root</option>
      <option name="allowedGnames"></option>
      <option name="dacs">755</option>
    </security_module>
    <security_module name="System Log File Permissions"/>
    <security_module name="System Logging Configuration File Permissions">
        <option name="fileList">/etc/syslog.conf</option>
        <option name="recursive">0</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="System Run Control Script Permissions"/>
    <security_module name="Use NOSUID and NODEV for Removable Media"/>
    <security_module name="Use NOSUID on User Filesystems"/>
    <security_module name="User Dot File Perms"/>
</profile>
