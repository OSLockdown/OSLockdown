<?xml version="1.0" encoding="UTF-8"?>
<profile name="NISPOM" sysProfile="true">
    <info>
        <description>
            <summary>NISPOM Chapter 8</summary>
            <verbose>Recommended for systems which operate under the purvue of the U.S. National Industrial Security Program.</verbose>
            <comments>The National Industrial Security Program Operating Manual (NISPOM) provides baseline standards for the protection of classified information released or disclosed to industry in connection with classified contracts under the NISP. The operating manual is provided under the under the authority of DoD Directive 5220.22, "National Industrial Security Program (NISP)," September 27, 2004.</comments>
        </description>
    </info>
    <security_module name="Access.conf File Permissions">
        <option name="fileList">/etc/security/access.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="At Directory Permissions">
        <option name="fileList">/var/spool/at</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="At/Cron Access File Permissions">
        <option name="fileList">/etc/at.allow /etc/at.deny /etc/cron.allow /etc/cron.deny</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,cron</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Audit Rules">
        <option name="auditRules">
# This file is automatically generated by OS Lockdown

# This file contains the auditctl rules that are loaded
# whenever the audit daemon is started via the initscripts.
# The rules are simply the parameters that would be passed
# to auditctl.

# First rule - delete all
-D

# Increase the buffers to survive stress events.
# Make this bigger for busy systems
-b 8192

# Feel free to add below this line. See auditctl man page

# Logins and Logouts
-w /bin/login -p x
-w /bin/su

-a exit,always -S mknod -S pipe -S mkdir -S creat -F success=0
-a exit,always -S open -F success=0
-a exit,always -F arch=b32 -S truncate -S ftruncate -F success=0
-a exit,always -F arch=b64 -S truncate -S ftruncate -F success=0

-a exit,always -S unlink -S rmdir -S rename -F success!=0

-w /bin/rm 

-a exit,always -F arch=b32 -S chmod -S fchmod -S chown -S fchown -S lchown
-a exit,always -F arch=b64 -S chmod -S fchmod -S chown -S fchown -S lchown

-a exit,always -S chroot -S mount -S umount -S umount2

-w /usr/sbin/pwck
-a exit,always -S adjtimex -S settimeofday -S kill

-w /bin/chgrp
-w /usr/bin/newgrp
-w /usr/sbin/groupadd
-w /usr/sbin/groupmod
-w /usr/sbin/groupdel

-w /usr/sbin/useradd
-w /usr/sbin/userdel
-w /usr/sbin/usermod
-w /usr/bin/chage
-a exit,always -S reboot -S init_module -S delete_module
-w /usr/bin/setfacl
-w /usr/bin/chacl
-a exit,always -S chmod -S fchmod -S link -S symlink
      </option>
    </security_module>
    <security_module name="Audit Rules (Solaris)">
        <option name="auditRules">
#
# This file is automatically generated by OS Lockdown
#   See audit_control(4) for more details
#   
# flags:
# -fr = GEN002720 (Audit Failed File and Program Access Attempts)
#  fd = GEN002740 (Audit File and Program Deletion)
#  am = GEN002760 (Audit Administrative, Privileged, and Security Actions)
#  ad = GEN002760 (old administrative (meta-class))
#  lo = GEN002800 (Audit Login, Logout, and Session Initiation)
#  fm = GEN002820 (Audit Discretionary Access Control Permission Modifications)
#   
# naflags:
#  lo = GEN002800 (Audit Login, Logout, and Session Initiation)
#  ex =           (exec)
#  ad =           (old administrative (meta-class))
#
dir:/var/audit
flags:-fr,fd,am,ad,lo,fm
naflags:lo,ex,ad
minfree:20
      </option>
    </security_module>
    <security_module name="Boot Loader Configuration File Permissions">
        <option name="fileList">/boot/grub</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Correct Uneven File Permissions"/>
    <security_module name="Create Login Banner">
        <option name="loginBanner">
THIS IS A U.S. GOVERNNMENT COMPUTER SYSTEM.  THIS COMPUTER SYSTEM,
INCLUDING ALL RELATED EQUIPMENT, NETWORKS, AND NETWORK DEVICES (SPECIFICALLY 
INCLUDING INTERNET ACCESS), ARE PROVIDED ONLY FOR AUTHORIZED US GOVERNMENT USE. 
DOD COMPUTER SYSTEMS MAY BE MONITORED FOR ALL LAWFUL PURPOSES, INCLUDING TO 
ENSURE THEIR USE IS AUTHORIZED, FOR MANAGEMENT OF THE SYSTEM, TO FACILITATE 
PROTECTION AGAINST UNAUTHORIZED ACCESS, AND TO VERIFY SECURITY PROCEDURES, 
SURVIVABILITY, AND OPERATIONAL SECURITY.  MONITORING INCLUDES ACTIVE ATTACKS BY 
AUTHORIZED DOD ENTITIES TO TEST OR VERIFY THE SECURITY OF THIS SYSTEM.  DURING 
MONITORING, INFORMATION MAY BE EXAMINED, RECORDED, COPIED, AND USED FOR 
AUTHORIZED PURPOSES.  ALL INFORMATION, INCLUDING PERSONAL INFORMATION, PLACED 
ON OR SENT OVER THIS SYSTEM, MAY BE MONITORED.

USE OF THIS DOD COMPUTER SYSTEM, AUTHORIZED OR UNAUTHORIZED, CONSTITUTES 
CONSENT TO MONITORING OF THIS SYSTEM.  UNAUTHORIZED USE MAY SUBJECT YOU TO 
CRIMINAL PROSECUTION.  EVIDENCE OF UNAUTHORIZED USE COLLECTED DURING MONITORING 
MAY BE USED FOR ADMINISTRATIVE, CRIMINAL, OR OTHER ADVERSE ACTION. USE OF THIS 
SYSTEM CONSTITUTES CONSENT TO MONITORING FOR THESE PURPOSES.
     </option>
    </security_module>
    <security_module name="Create Login FTP Banner">
        <option name="ftpLoginBanner">Authorized uses only. All activity may be monitored and reported.</option>
    </security_module>
    <security_module name="Create ftpusers File"/>
    <security_module name="Crontab Perms">
        <option name="userSpoolDirs">/var/spool/cron/ /etc/crontab</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root cron </option>
        <option name="userCanOwn">1</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Default umask">
        <option name="defaultUmask">077</option>
    </security_module>
    <security_module name="Disable Ctrl-Alt-Del"/>
    <security_module name="Disable FTP (gssftp)"/>
    <security_module name="Disable FTP (vsftpd)"/>
    <security_module name="Disable Finger"/>
    <security_module name="Disable Remote Exec (rexec)"/>
    <security_module name="Disable Remote Login (rlogin)"/>
    <security_module name="Disable Remote Shell (rsh)"/>
    <security_module name="Disable TFTP"/>
    <security_module name="Disable Telnet"/>
    <security_module name="Disable USB and PCMCIA Devices">
        <option name="usbDevices">2</option>
    </security_module>
    <security_module name="Disable UUCP"/>
    <security_module name="Enable the Audit Subsystem"/>
    <security_module name="Exec shell startups in /etc/profile.d"/>
    <security_module name="Expired Password Invalidation"/>
    <security_module name="FTP Configuration File Permissions">
        <option name="fileList">/etc/ftpusers /etc/vsftpd.ftpusers</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Global Initialization File Permissions">
        <option name="fileList">/etc/bashrc /etc/csh.cshrc /etc/csh.login /etc/csh.logout, /etc/environment,
                                /etc/ksh.kshrc, /etc/profile, /etc/profile.d /etc/suid_profile</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,other,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Home Directory Contents"/>
    <security_module name="Home Directory Ownership"/>
    <security_module name="Home Directory Permissions"/>
    <security_module name="Hosts File Permissions">
        <option name="fileList">/etc/hosts</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Inetd/Xinetd Configuration File Permissions">
        <option name="fileList">/etc/xinetd.conf /etc/xinetd.d/*</option>
        <option name="recursive">1</option>
        <option name="globNames">1</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="InterNetNews Config File Perms">
        <option name="fileList">/etc/news/*</option>
        <option name="globNames">1</option>
        <option name="allowedUnames">root,news</option>
        <option name="allowedGnames">root,news</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Kernel Core Dump Directory Permissions">
        <option name="fileList">/var/crash</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">700</option>
    </security_module>
    <security_module name="LDAP Configuration File Permissions">
        <option name="fileList">/etc/ldap.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Lock Invalid Accounts"/>
    <security_module name="Lock Non-Root Accounts with UID 0"/>
    <security_module name="Lock account after three failed login attempts"/>
    <security_module name="Management Information Base (MIB) File Permissions">
        <option name="fileList">/usr/share/snmp/mibs/*.txt /usr/share/snmp/mibs/*.mib</option>
        <option name="recursive">0</option>
        <option name="globNames">1</option>
        <option name="allowedUnames"/>
        <option name="allowedGnames"/>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="Maximum Time Between Password Changes">
        <option name="passwordMaxdays">42</option>
    </security_module>
    <security_module name="NFS Export Configuration File Permissions">
        <option name="fileList">/etc/exports</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="NIS/NIS+/YP Configuration File Permissions">
        <option name="fileList">/etc/yp /var/yp /etc/yp.conf</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin,sys</option>
        <option name="allowedGnames">root,bin,sys</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="Name Service Switch Configuration File Permissions">
        <option name="fileList">/etc/nsswitch.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="No Empty Passwords"/>
    <security_module name="Password Perms">
        <option name="fileList">/etc/passwd /etc/group</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Password Policy Length Minimum">
        <option name="passwordMinLength">12</option>
    </security_module>
    <security_module name="Password Policy Lowercase Minimum"/>
    <security_module name="Password Policy Numeric Minimum"/>
    <security_module name="Password Policy Special Characters"/>
    <security_module name="Password Policy Uppercase Minimum"/>
    <security_module name="Printer Configuration File Permissions">
        <option name="fileList">/etc/cups/printers.conf</option>
        <option name="recursive">0</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">lp</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Require GRUB Password"/>
    <security_module name="Resolver Configuration File Permissions">
        <option name="fileList">/etc/resolv.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Restrict Use of Compiler Tools"/>
    <security_module name="Restrict Use of Traceroute and Ping">
        <option name="fileList">/bin/traceroute /usr/sbin/traceroute</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys</option>
        <option name="dacs">700</option>
    </security_module>
    <security_module name="Restrict Write-Access on Man Pages">
        <option name="fileList">/usr/share/man /usr/share/info /usr/share/infopage</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames"/>
        <option name="allowedGnames"/>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="SNMP Configuration File Permissions">
        <option name="fileList">/etc/snmp</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="SSHD Disable Empty Passwords"/>
    <security_module name="SSHD Disable Root Login"/>
    <security_module name="SSHD Enable Banner"/>
    <security_module name="Samba Configuration File Permissions">
        <option name="fileList">/etc/samba/smb.conf</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Samba Password File Permissions">
        <option name="fileList">/etc/samba/passdb.tdb /etc/samba/secrets.tdb</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root</option>
        <option name="dacs">600</option>
    </security_module>
    <security_module name="Secure Audio Devices"/>
    <security_module name="Secure Authpriv Logging"/>
    <security_module name="Secure SUID/SGID Executables"/>
    <security_module name="Secure Shell Binaries">
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,sys,bin,system</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="Secure Unowned Files"/>
    <security_module name="Secure World Writable Directories"/>
    <security_module name="Secure World Writable Files"/>
    <security_module name="Services File Permissions">
        <option name="fileList">/etc/services</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,bin,sys,system</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Set CDE Screen Saver">
        <option name="cdeSaverActivate">10</option>
    </security_module>
    <security_module name="Set FTP Umask (gssftp)"/>
    <security_module name="Set Mandatory Screen Saver">
        <option name="gnomeSaverActivate">10</option>
    </security_module>
    <security_module name="Set TFTP Startup Directory"/>
    <security_module name="Set X Screen Saver Application Defaults">
        <option name="XscreenSaverActivate">10</option>
    </security_module>
    <security_module name="Set delay after failed login">
        <option name="loginDelay">4</option>
    </security_module>
    <security_module name="Set shell timeout period">
        <option name="shellTimeout">900</option>
    </security_module>
    <security_module name="Skeleton File Permissions">
        <option name="fileList">/etc/skel</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root,bin</option>
        <option name="allowedGnames">root,bin,sys,system,other</option>
        <option name="dacs">644</option>
    </security_module>
    <security_module name="Sysctl.conf Permissions"/>
    <security_module name="System Command File Permissions">
        <option name="fileList">/etc /bin /usr/bin /usr/lbin /usr/usb /sbin /usr/sbin</option>
        <option name="recursive">1</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin</option>
        <option name="dacs">755</option>
    </security_module>
    <security_module name="System Configuration File Permissions"/>
    <security_module name="System Device Directory Ownership"/>
    <security_module name="System Library File Permissions">
      <option name="fileList">/lib /lib64 /usr/lib /usr/lib64</option>
      <option name="recursive">1</option>
      <option name="globNames">0</option>
      <option name="allowedUnames">root</option>
      <option name="allowedGnames"></option>
      <option name="dacs">755</option>
    </security_module>
    <security_module name="System Log File Permissions"/>
    <security_module name="System Logging Configuration File Permissions">
        <option name="fileList">/etc/syslog.conf</option>
        <option name="recursive">0</option>
        <option name="globNames">0</option>
        <option name="allowedUnames">root</option>
        <option name="allowedGnames">root,sys,bin,system</option>
        <option name="dacs">640</option>
    </security_module>
    <security_module name="System Run Control Script Permissions"/>
    <security_module name="User Mountable Media"/>
</profile>
